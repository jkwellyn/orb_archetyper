<%= partial('_tasks_report.erb')%>
require 'rspec/core/rake_task'
require 'test_support/tasks/task_helpers'

def build_rake_task(task_name)
  file_pattern = "<%= file_pattern %>"
  # only build the rake task if you find spec files
  return nil if Dir.glob(file_pattern).empty?
  RSpec::Core::RakeTask.new(task_name.to_sym) do |task|
    TestSupport::Tasks::TaskHelpers.build_rspec_opts(task_name, task)
    task.pattern = file_pattern
  end
end

namespace :spec do
  all_possible_tasks = <%= test_types %>
  actual_tasks = []
  all_possible_tasks.each do |task|
    task_added = build_rake_task(task)
    actual_tasks << "spec:#{task}" if task_added
  end

  task full: actual_tasks
end
